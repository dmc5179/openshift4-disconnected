---
# tasks file for pip

- name: Create directory for mirroring pip modules
  file:
    path: '{{ mirror_base }}/pip'
    state: directory
  tags:
    - mirror

- name: Download pip modules
  shell:
    cmd: {{ pip_cmd }} download -d '{{ mirror_base }}/pip' "{{ item.name }}=={{ item.version }}"
  with_items:
    - '{{ pip_modules }}'
  tags:
    - mirror

- name: Install mirrored pip modules
  shell:
    cmd: {{ pip_cmd }} install --user -d '{{ mirror_base }}/pip' "{{ item.name }}=={{ item.version }}"
  with_items:
    - '{{ pip_modules }}'
  tags:
    - install
